local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/jensonhirst/Orion/main/source"))()
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- Create the main window
local Window = OrionLib:MakeWindow({
    Name = "Kaka hub DoD",
    HidePremium = false,
    SaveConfig = true,
    IntroEnabled = false
})

local InfoTab = Window:MakeTab({
    Name = "Information",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})

InfoTab:AddParagraph("General Info", [[
This GUI contains multiple tabs with functions:

- Premake Tab: Predefined ability sets. Click buttons to set abilities quickly.
- Blatant Tab: Use abilities manually. Select ability from dropdown and click 'Use Ability'.
- Funny Tab: Change animations and perform funny actions like 'Howl'. Toggle auto-Howl every 2 seconds.
- Aimbot Tab: Aim automatically when performing specific abilities:
    * Taunt Aimbot: Targets players automatically when Taunt animation plays.
    * Punch Aimbot: Targets players automatically when Punch animation plays.
    * CareTaker Aimbot: Targets nearest, lowest health, all, or normal. Always aims straight, no prediction.
- Update Logs: Check all functions and latest changes.

Use toggles to activate features, dropdowns for options, and text boxes for prediction or distance values.
]])

-- Abilities list
local abilities = {
    "Adrenaline",
    "Banana",
    "Block",
    "Dash",
    "Cloak",
    "Hotdog",
    "BonusPad",
    "Caretaker",
    "Taunt",
    "Punch",
    "Revolver"
}

local selected1 = "Banana"
local selected2 = "Caretaker"

-- =======================
-- Abilities Tab
-- =======================
local AbilitiesTab = Window:MakeTab({
    Name = "Abilities",
    PremiumOnly = false
})

-- Slot 1 dropdown
AbilitiesTab:AddDropdown({
    Name = "Ability Slot 1",
    Default = selected1,
    Options = abilities,
    Callback = function(Value)
        selected1 = Value
    end
})

-- Slot 2 dropdown
AbilitiesTab:AddDropdown({
    Name = "Ability Slot 2",
    Default = selected2,
    Options = abilities,
    Callback = function(Value)
        selected2 = Value
    end
})

-- Main Set Abilities button
AbilitiesTab:AddButton({
    Name = "Set Abilities",
    Callback = function()
        local args = { { selected1, selected2 } }
        local rep = game:GetService("ReplicatedStorage")
        local events = rep:FindFirstChild("Events")
        if not events then
            warn("Events folder not found")
            return
        end
        local remotes = events:FindFirstChild("RemoteEvents")
        if not remotes then
            warn("RemoteEvents not found")
            return
        end
        local abilityRemote = remotes:FindFirstChild("AbilitySelection")
        if not abilityRemote or not abilityRemote:IsA("RemoteEvent") then
            warn("AbilitySelection RemoteEvent not found or invalid")
            return
        end

        pcall(function()
            abilityRemote:FireServer(unpack(args))
        end)
    end
})

-- =======================
-- Premake Tab
-- =======================
local PremakeTab = Window:MakeTab({
    Name = "Premake",
    PremiumOnly = false
})

local function sendAbilities(slot1, slot2)
    local args = { { slot1, slot2 } }
    local rep = game:GetService("ReplicatedStorage")
    local events = rep:FindFirstChild("Events")
    if not events then
        warn("Events folder not found")
        return
    end
    local remotes = events:FindFirstChild("RemoteEvents")
    if not remotes then
        warn("RemoteEvents not found")
        return
    end
    local abilityRemote = remotes:FindFirstChild("AbilitySelection")
    if not abilityRemote or not abilityRemote:IsA("RemoteEvent") then
        warn("AbilitySelection RemoteEvent not found or invalid")
        return
    end

    pcall(function()
        abilityRemote:FireServer(unpack(args))
    end)
end

-- Loveshot button
PremakeTab:AddButton({
    Name = "Loveshot",
    Callback = function()
        selected1 = "Revolver"
        selected2 = "Caretaker"
        sendAbilities(selected1, selected2)
    end
})

-- Carepad button
PremakeTab:AddButton({
    Name = "Carepad",
    Callback = function()
        selected1 = "Caretaker"
        selected2 = "BonusPad"
        sendAbilities(selected1, selected2)
    end
})

PremakeTab:AddLabel("Forsaken Deck")

PremakeTab:AddButton({
    Name = "Guest 1337",
    Callback = function()
        local args = { "Block", "Punch" }
        local rep = game:GetService("ReplicatedStorage")
        local events = rep:WaitForChild("Events")
        local remotes = events:WaitForChild("RemoteEvents")
        local abilityRemote = remotes:WaitForChild("AbilitySelection")
        pcall(function()
            abilityRemote:FireServer(unpack({args}))
        end)
    end
})

PremakeTab:AddButton({
    Name = "Noob",
    Callback = function()
        local args = { "Cloak", "Adrenaline" }
        local rep = game:GetService("ReplicatedStorage")
        local events = rep:WaitForChild("Events")
        local remotes = events:WaitForChild("RemoteEvents")
        local abilityRemote = remotes:WaitForChild("AbilitySelection")
        pcall(function()
            abilityRemote:FireServer(unpack({args}))
        end)
    end
})

-- Shedletsky button
PremakeTab:AddButton({
    Name = "Shedletsky",
    Callback = function()
        local args = { "Punch", "Hotdog" }
        local rep = game:GetService("ReplicatedStorage")
        local events = rep:WaitForChild("Events")
        local remotes = events:WaitForChild("RemoteEvents")
        local abilityRemote = remotes:WaitForChild("AbilitySelection")
        pcall(function()
            abilityRemote:FireServer(unpack({args}))
        end)
    end
})

-- Two Time Temu button
PremakeTab:AddButton({
    Name = "Two Time Temu",
    Callback = function()
        local args = { "Punch", "Dash" }
        local rep = game:GetService("ReplicatedStorage")
        local events = rep:WaitForChild("Events")
        local remotes = events:WaitForChild("RemoteEvents")
        local abilityRemote = remotes:WaitForChild("AbilitySelection")
        pcall(function()
            abilityRemote:FireServer(unpack({args}))
        end)
    end
})

local AimbotTab = Window:MakeTab({
    Name = "Aimbot",
    PremiumOnly = false
})

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")

-- Fixed helper function to rotate HRP toward target
local function faceTarget(hrp, targetPos)
    local dir = Vector3.new(targetPos.X - hrp.Position.X, 0, targetPos.Z - hrp.Position.Z)
    if dir.Magnitude < 0.1 then return end -- ignore if too close
    dir = dir.Unit
    local yaw = math.atan2(dir.X, dir.Z)
    hrp.CFrame = CFrame.new(hrp.Position) * CFrame.Angles(0, yaw, 0)
end

-- Aimbot toggles
local tauntActive, punchActive, careActive, revolverActive = false, false, false, false

-- Taunt Aimbot
AimbotTab:AddToggle({
    Name="Taunt Aimbot",
    Default=false,
    Callback=function(state) tauntActive = state end
})

-- Punch Aimbot
AimbotTab:AddToggle({
    Name="Punch Aimbot",
    Default=false,
    Callback=function(state) punchActive = state end
})

-- CareTaker Aimbot
AimbotTab:AddToggle({
    Name="CareTaker Aimbot",
    Default=false,
    Callback=function(state) careActive = state end
})

-- Revolver Aimbot
local revolverPredictionValue = 3
local revolverPredictionMode = "Straight"

AimbotTab:AddToggle({
    Name="Revolver Aimbot",
    Default=false,
    Callback=function(state) revolverActive = state end
})

-- Main Heartbeat loop
RunService.Heartbeat:Connect(function()
    pcall(function()
        local char = LocalPlayer.Character
        if not char then return end
        local humanoid = char:FindFirstChildOfClass("Humanoid")
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not humanoid or not hrp then return end

        for _, track in ipairs(humanoid:GetPlayingAnimationTracks()) do
            if track.Animation then
                local animId = track.Animation.AnimationId

                -- Taunt Aimbot
                if tauntActive and animId == "rbxassetid://113732291990231" then
                    local nearest, nearestDist = nil, math.huge
                    for _, plr in ipairs(Players:GetPlayers()) do
                        if plr ~= LocalPlayer and plr.Character then
                            local hum = plr.Character:FindFirstChildOfClass("Humanoid")
                            local tph = plr.Character:FindFirstChild("HumanoidRootPart")
                            if hum and tph and hum.Health > 150 then
                                local dist = (hrp.Position - tph.Position).Magnitude
                                if dist < nearestDist then
                                    nearestDist = dist
                                    nearest = tph
                                end
                            end
                        end
                    end
                    if nearest then faceTarget(hrp, nearest.Position) end
                end

                -- Punch Aimbot
                if punchActive and animId == "rbxassetid://124781750889573" then
                    local nearest, nearestDist = nil, math.huge
                    for _, plr in ipairs(Players:GetPlayers()) do
                        if plr ~= LocalPlayer and plr.Character then
                            local hum = plr.Character:FindFirstChildOfClass("Humanoid")
                            local tph = plr.Character:FindFirstChild("HumanoidRootPart")
                            if hum and tph and hum.Health > 150 then
                                local dist = (hrp.Position - tph.Position).Magnitude
                                if dist < nearestDist then
                                    nearestDist = dist
                                    nearest = tph
                                end
                            end
                        end
                    end
                    if nearest then faceTarget(hrp, nearest.Position) end
                end

                -- CareTaker Aimbot
                if careActive and animId == "rbxassetid://128767098320893" then
                    local nearest, nearestDist = nil, math.huge
                    for _, plr in ipairs(Players:GetPlayers()) do
                        if plr ~= LocalPlayer and plr.Character then
                            local hum = plr.Character:FindFirstChildOfClass("Humanoid")
                            local tph = plr.Character:FindFirstChild("HumanoidRootPart")
                            if hum and tph and hum.Health <= 200 then
                                local dist = (hrp.Position - tph.Position).Magnitude
                                if dist < nearestDist then
                                    nearestDist = dist
                                    nearest = tph
                                end
                            end
                        end
                    end
                    if nearest then faceTarget(hrp, nearest.Position) end
                end

                -- Revolver Aimbot
                if revolverActive and animId == "rbxassetid://74108653904830" then
                    local nearest, nearestDist = nil, math.huge
                    for _, plr in ipairs(Players:GetPlayers()) do
                        if plr ~= LocalPlayer and plr.Character then
                            local hum = plr.Character:FindFirstChildOfClass("Humanoid")
                            local tph = plr.Character:FindFirstChild("HumanoidRootPart")
                            if hum and tph and hum.Health > 130 then
                                local dist = (hrp.Position - tph.Position).Magnitude
                                if dist < nearestDist then
                                    nearestDist = dist
                                    nearest = tph
                                end
                            end
                        end
                    end
                    if nearest then
                        local predictedPos = nearest.Position + (nearest.Velocity.Unit * revolverPredictionValue)
                        if revolverPredictionMode == "Sideway" then
                            local vel = nearest.Velocity
                            local perp = Vector3.new(-vel.Z,0,vel.X)
                            if perp.Magnitude>0.01 then predictedPos = nearest.Position + perp.Unit*revolverPredictionValue end
                        end
                        faceTarget(hrp, predictedPos)
                    end
                end

            end
        end
    end)
end)

-- =======================
-- Blatant Tab
-- =======================
local BlatantTab = Window:MakeTab({
    Name = "Blatant",
    PremiumOnly = false
})

local selectedAbility = abilities[1] -- default

-- Dropdown for Blatant tab
BlatantTab:AddDropdown({
    Name = "Select Ability",
    Default = selectedAbility,
    Options = abilities,
    Callback = function(value)
        selectedAbility = value
    end
})

-- Button to Use Ability
BlatantTab:AddButton({
    Name = "Use Ability",
    Callback = function()
        -- Fire the ability
        local args = { selectedAbility }
        local rep = game:GetService("ReplicatedStorage")
        local events = rep:WaitForChild("Events")
        local remotes = events:WaitForChild("RemoteFunctions")
        local useAbility = remotes:WaitForChild("UseAbility")
        pcall(function()
            useAbility:InvokeServer(unpack(args))
        end)
    end
})

local blatantToggleActive = false

BlatantTab:AddToggle({
    Name = "Stun Helper (Punch)",
    Default = false,
    Callback = function(state)
        blatantToggleActive = state
        if state then
            spawn(function()
                local lp = LocalPlayer
                while blatantToggleActive do
                    if lp.Character and lp.Character:FindFirstChildOfClass("Humanoid") then
                        local humanoid = lp.Character:FindFirstChildOfClass("Humanoid")
                        for _, track in pairs(humanoid:GetPlayingAnimationTracks()) do
                            if track.Animation.AnimationId == "rbxassetid://124781750889573" then
                                local hrp = lp.Character:FindFirstChild("HumanoidRootPart")
                                if hrp then
                                    -- Find one valid target only
                                    local target = nil
                                    for _, plr in pairs(game:GetService("Players"):GetPlayers()) do
                                        if plr ~= lp and plr.Character and plr.Character:FindFirstChildOfClass("Humanoid") then
                                            local targetHumanoid = plr.Character:FindFirstChildOfClass("Humanoid")
                                            if targetHumanoid.Health > 233 and plr.Character:FindFirstChild("HumanoidRootPart") then
                                                target = plr.Character.HumanoidRootPart
                                                break
                                            end
                                        end
                                    end

                                    if target then
                                        local originalCFrame = hrp.CFrame
                                        -- teleport behind + face target
                                        local behindCFrame = target.CFrame * CFrame.new(0, 0, -2)
                                        hrp.CFrame = CFrame.lookAt(behindCFrame.Position, target.Position)

                                        -- keep facing target for 0.7 sec
                                        local start = tick()
                                        while tick() - start < 0.7 and blatantToggleActive and hrp and target do
                                            hrp.CFrame = CFrame.lookAt(hrp.Position, target.Position)
                                            game:GetService("RunService").Heartbeat:Wait()
                                        end

                                        -- teleport back safely
                                        if hrp then
                                            hrp.CFrame = originalCFrame
                                        end
                                    end
                                end
                            end
                        end
                    end
                    wait(0.1)
                end
            end)
        end
    end
})

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")

local FunnyTab = Window:MakeTab({
    Name = "Funny",
    PremiumOnly = false
})

local function playAnim(animId)
    local char = LocalPlayer.Character
    if not char then return end
    local humanoid = char:FindFirstChildOfClass("Humanoid")
    if not humanoid then return end

    local anim = Instance.new("Animation")
    anim.AnimationId = "rbxassetid://"..animId
    local track = humanoid:LoadAnimation(anim)
    track:Play()
end

-- Crash Out button
FunnyTab:AddButton({
    Name = "Crash Out",
    Callback = function()
        playAnim("130725432915474")
    end
})

-- Howl button
FunnyTab:AddButton({
    Name = "Howl",
    Callback = function()
        playAnim("109803302620003")
    end
})

-- BackShot toggle
do
    local active = false
    local animId = "109803302620003"
    local lastTime = 0

    FunnyTab:AddToggle({
        Name = "BackShot",
        Default = false,
        Callback = function(state) active = state end
    })

    RunService.Heartbeat:Connect(function(dt)
        if not active then return end
        lastTime = lastTime + dt
        if lastTime >= 0.7 then
            lastTime = 0
            playAnim(animId)
        end
    end)
end

OrionLib:Init()
